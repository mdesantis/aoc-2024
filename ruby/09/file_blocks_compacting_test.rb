# frozen_string_literal: true

require 'bundler/setup'
require 'minitest/autorun'
require 'minitest/pride'

require_relative 'file_blocks_compacting'

INPUT_CONTENTS = '2333133121414131402'

class TestFileBlocksCompacting < Minitest::Test
  def test_filesystem_checksum_after_file_blocks_compacting
    result = FileBlocksCompacting.new(INPUT_CONTENTS).filesystem_checksum_after_file_blocks_compacting

    assert_equal 1928, result
  end
end

class TestFileBlocksCompactingDealingWithFileSystemFragmentation < Minitest::Test
  def test_filesystem_checksum_after_file_blocks_compacting
    result = FileBlocksCompactingDealingWithFileSystemFragmentation
      .new(INPUT_CONTENTS)
      .filesystem_checksum_after_file_blocks_compacting

    assert_equal 2858, result
  end

  def test_filesystem_checksum_after_file_blocks_compacting_with_data_as_input_contents
    unless Object.const_defined? :DATA
      return skip "Skipping as `DATA` constant is not defined. Execute `ruby #{__FILE__}` to run this test."
    end

    result = FileBlocksCompactingDealingWithFileSystemFragmentation
      .new(DATA.read)
      .filesystem_checksum_after_file_blocks_compacting

    assert_equal 807104427291, result
  end
end

__END__
597684543525678893854757528934504911211961265147739364944958816090557594646650668238415729413892225511659915573163453699612488473960571048177091778455102943535060922827608663846989537317944057609076309844737813483784503728742741336630522851151770744859483536527059218929524129597997866058184373782388675130674140948019254581626697284062827661427761369635822687891264451518633482183235289846257296618940412936607931698825346071643056222136814775306522269396946427327571109418246049408965338019243663656519222294911076595524699834573920682144453282768052651197108412186827927373283410342223837962793553229632404074281577248161933135284311455714403432476642978990441276864449808940885355779753699735461651395710492455762173772977273432491978317458189645139717335158229594588992202473284168978945559540368597228086387241235516506948238772229165717653347558762531206816521690633039699921599028211123809976905919715361736337157893301191385018431714934335805335298646201776624630213013339657498384732770167563475114868341225291677976983724147174134483252734963889423079233811535456383069108687934713868038268348536376672195391280743919375164165663278845482765361195927939147767119710197581546928903097334340147474377570869654983949232620595316659337672069618427922188905452115010262348285024512847221493711265914263255168763028933726212029412288766273486239465035865062127345683375422520934186469727259793483341842033753272251346461765574034411725579744399093319230521431611591156655403099612360847434679883123980362166295215963932458178727658817598489867935576674756388428783653538248937820671635513961829137603215388752693644701848413884415961185519131852741174548114913966613730245079367085754191458722954939935684211380602843467928177398855519702026474370476985534112674383333278736331235281393650348338124874269295945858792516995436386010411113543380369632988970219168313324646379324523281320821617829675378938336919475620409423932548814238915313374837925572876252968237169878885124547178529638333622275312771440541460894354928143545745975895867597606769463635483484246224799688762430118970229014284095627090202066302071655899753583866716349288492193837096899775871099628732431611395294767643899483548033537552336414895494787022733770906842486242932650345728866489708153126356762452385777903658785024276913794420237799582263261960517555662293587814975517956755328162986356186961417657189626783777196416523238178293422841433688287484524442181713273231866312199183152388342358531147498590767416936393192057347433664041168570764162625099707332655516411997481574665592206250741765736375445051935628566371128478605159592714877861214357423771518464406443345787271684102120209163806891294094463463727472616784558742118771848162928399699537125638971972565164284847728877538282213313548645632740178631955741847698171235155930208020291148974353913118721869755744733567788120722153133692746635408240789786723853821823358475238026729965882460492612148778133522869948307542939286805388882652913932875472963462719584976224944730159070995377605444189392484990866250515697802752743484688295666769515984856051946554238821462862985147366651622119528219856775747011941664216519494542518679954036603714298445606657879237348491782834977211431850522110879534548096903999906571946121164014267831752969523391124640908197922731187958323172909167723965248679864499109699646648449231613378873616167217866670948081268541595862559757504128156314646974375266302763405481738327987779993752223261706461764272796592103097916226504457924077983550523224681688721527233753983532324399506432278827856538785374454726201810633069481374413279182694888877443211856575693844451826341425568371273234356780775958729153239244329115732574471395705896236553515723817487138416745454447397592097197940318515572646121239629171708233147861769626257537196861903262699991778775687661434754804325857441463467143969235416626777962129312524374364538395394590402455728124578299383561149685491338226015997238607389352448587471851764865220982661225543847521436882601834891180376373417525681184933478291376738314954630684113668478284250177553687927432590389650233451388385115734925162942885955360591872533730868323636845965463583155143745132462758172711213634572143534161152351182767526182530818092515612996811269082394626288936985146247417798197455612111653976693563639265825703289207656111929757322552477408220786936139310615756446963639084547523817770621523691592519191427727243971451179391457647226591410327860671954916930932137696240697131478191432138392321231857259089159759912613163083388120412522824684302119941488572875761115853576376225882228974631429242843398436557812011931595842493875326836130471459193669336010419269644211873372799280243663875924581613448487893195897763132014432130127869998357852295397192471691658944341653298831739526358828995638479521949556324635879466585140105439326054155011479222824172551224629963657667723831598621865523398896331870352921118563531589918766318939328579985047112246309311219447987028939430684559204634725456972431348918779967313074249760268441237949957910587951812063985280984774953763455017552499219570521057949647198572605343392040525165995514987812664485648834678789952442769558275263945996482123525262688775662834888979468935905594817834581625375743165238113050847223431969659314218041754113357557308928109826155447401963562061801288256091528051638775818859625668519148108180359320799230382234248862206544789048169146868163733339919932288628938579167516632761229728831225479144337777585142447724419391845137146866201343648044509981714729426155136572942470431915537858862583845160837364728160835713342133125950625964595389857984852646256784435120481440274968414230814398496354278568438226905044178433194783976671165691814232995750214028618210599899703067807555706289641899872042876949898992359558363695337135952731436355966534233123679766356183484551396770987890131699529016473259194085685266949044763396976694565980335574119822902751975256907715285546527565995249582832229829336011767316668197203891218763199774541823288762449460753639506093268535682073226745554439626886245983347235259898462815974832544835863593446873616117657183125427228263334695908429885949599361259425927370208787781088122166408359324254171243916242416089101024915823776138814843772356818494739917527689835323849510825049988781988371106162229426644245229432373918834685777672864020146873501643196693836557368482736765572097489386267852264996841684537647795759144316988289638717668133349990734442845824872619308330487973487035922620421266605495986445877254813368403624537541578366552244992795126143353477176496139254262148286382926587549311281078123244271934885483752658735634177527554075214688174837489074999936111256769550489424997546442244715774124399935827289784713556291213453410993220813928494392985520815266579048137121566067862896956746928999954619489985854388439250819342565145245712495537537696642154455933648512501167312513512431431696173468224623467890934032197855453726947757119525771433247836899010234614892928162212812929658338715997798161373581369635271369455913247665838851435836455571137399701353378150244636273120244523401580525671226791322354607453776395936699582289931119763146908343537123599284895457696771319882325361736057115962767878669042328860597499225841105858288035693167391831249533265568508898918753832869196170612843406897831435115873184572722960243212459075748129135467686765427898182550934386528856728585469644739929575690579462376266555365892567269967356869234864695244945789745767505587204680403838721011141988364235115877559962983445319316241541617339905138768457437654878674584149357759766518508818792486102694579477284626861023844829402286688659292983829611548781314438642932456012589843209546487132478249556146562554541860896626561885765069398680561243927346363152303946152861802095733488137730986469418411425911781810814234163926728246354547838839965423367078171876164425445064562466121532293826489068355483566372203031408019318723359445576195807411418932191311601256268263668328228222945546494892667873533065102738341726651154506198914394948178214179424596636477767397182115465287463977816271525960785799392515986783469314583053553655962851672563117770186934911138677320194559525211483737872816604863219873847826849598332890785458427836861649267857523847609574221691923928845260454938723251653091146096394034164961232337844573945232612547831246484359672030165162184653749017916163671889566682889456432669303695313349998749693084433570523357952574745056837281468529568288704583546063306237125779927433207175567868703237974311613359746772581514584259864678802751114456927841504083506895998482976741182473693099604422342827865627982064766844606444983315789849778174845858774620659113311439419520939610328712537379135472723686875741541854865949431626495651166740346477402810651181391684996540739231977977805545289229284187833669967324689426329718201385998276322380846838887390953031957718581575234532741136313729169718191648612578898716413013444824836738379615262252693548193520101151415524646730299194562024973324508330462574199127996089274195862469212186806687219180236748992013425631644331471412915347528021431141175665363796396741563790308895339853511589243957774319619561245886465396224242171244387127247537546029282668732085949180142934154582348760771660418427278357152898362328729495881979158373934070214534161878982314375711145673406329689811804994451667993276776427832123807922556399835723613491415629799152371228614465889632578356899767968219139960895551712193958334719153634941601532746274974133746141162570556861848624642863691377759225209173618849672686969956366119813839805041467710947624222756756184653429726914902246946845857899805245727753135788517026979828462378728464503878163519801479211526584039985285591397748759347155679777801042616830574314127870791562677130387445458536284114203532184922726862686689769165814839947443464844673519808086257921547016884292395866953213382960665589149281458211704772545434267942298254506099479468689457666279935335132326161641384536165988687
